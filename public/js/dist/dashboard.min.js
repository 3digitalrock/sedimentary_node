/*! 3drs-sedimentary 2014-10-10 */
angular.module("userModule",["ngRoute","ui.router"]).config(["$stateProvider","$urlRouterProvider",function(a){a.state("usersAll",{url:"/dashboard/users/all",templateUrl:"/admin/views/user_all.html",controller:"AdminUserAllCtrl"}).state("usersDetails",{url:"/dashboard/users/:userId",templateUrl:"/admin/views/user_detail.html",resolve:{userPromise:["Restangular","$stateParams",function(a,b){return a.one("users",b.userId).get().then(function(a){return a})}]},controller:"AdminUserDetailsCtrl"}).state("dashLogin",{url:"/dashboard/login",templateUrl:"/admin/views/login.html",data:{login:!0},controller:"AdminLoginCtrl"})}]),angular.module("userModule").controller("AdminLoginCtrl",["$scope",function(a){a.user.first_name="Friend"}]),angular.module("videoModule",["ngRoute","ui.router"]).config(["$stateProvider","$urlRouterProvider",function(a){a.state("videosList",{url:"/dashboard/videos/all",templateUrl:"/admin/views/video_all.html",controller:"AdminVideoListCtrl",resolve:{videosPromise:["Restangular",function(a){return a.all("videos").getList({fields:"uid,title,slug,description,studio,created,status"}).then(function(a){return a})}]}}).state("videosUpload",{url:"/dashboard/videos/upload",templateUrl:"/admin/views/video_create.html",controller:"AdminVideoUploadCtrl"}).state("videosDetails",{url:"/dashboard/videos/:videoId",templateUrl:"/admin/views/video_detail.html",controller:"AdminVideoDetailsCtrl",resolve:{videoPromise:["Restangular","$stateParams",function(a,b){return a.one("videos",b.videoId).get({fields:"uid,title,description,channels,studio,status,files,thumbnails"}).then(function(a){return a})}],studiosPromise:["Restangular",function(a){return a.all("studios").getList().then(function(a){return a})}],channelsPromise:["Restangular",function(a){return a.all("channels").getList().then(function(a){return a})}]}})}]),angular.module("videoModule").controller("AdminVideoListCtrl",["$scope","videosPromise",function(a,b){a.videos=b,a.predicate="upload"}]).directive("vidstatus",function(){var a={1:'<span class="label label-success">Approved</span>',2:'<span class="label label-warning">Pending</span>',3:'<span class="label">Processing</span>',4:'<span class="label label-alert">Rejected</span>',0:'<span class="label label-default">Unknown</span>'};return{restrict:"E",replace:!0,link:function(b,c,d){d.$observe("code",function(b){c.html(a[b])})}}}),angular.module("videoModule").controller("AdminVideoDetailsCtrl",["$scope","$filter","Restangular","$route","$location","$timeout","videoPromise","studiosPromise","channelsPromise",function(a,b,c,d,e,f,g,h,i){a.video=g;var j=jsonpatch.observe(a.video);a.studios=[],_.forEach(h,function(b){a.studios.push({value:b.uid,text:b.name})}),a.channels=[],_.forEach(i,function(b){a.channels.push({value:b.uid,text:b.name})}),console.log(a.video),a.showStudio=function(){var c=b("filter")(a.studios,{value:a.video.studio.uid});return console.log(c),a.video.studio.uid&&c.length?c[0].text:"Not set"},a.showChannels=function(){var b=[];return angular.forEach(a.channels,function(c){a.video.channels.indexOf(c.value)>-1&&b.push(c.text)}),b.length?b.join(", "):"Not set"},a.updateVideo=function(){var b=jsonpatch.generate(j);c.one("videos",a.video.uid).patch(b).then(function(){},function(){})},a.gogoPlayerRanger=function(){videojs("video-player",{plugins:{resolutions:!0}}).ready(function(){function a(){var a=9/16,c=document.getElementById(b.id()).parentElement.offsetWidth;c-=parseInt($("#video-player").parent().css("padding-left")),c-=parseInt($("#video-player").parent().css("padding-right")),b.width(c).height(c*a)}var b=this;b.volume(.75),a(),window.onresize=a}),videojs.options.flash.swf="/js/vendor/video-js.swf"},a.showPlayer=function(){f(function(){a.gogoPlayerRanger()},0)},a.showPlayer(),a.$on("$destroy",function(){videojs("video-player").dispose(),videojs.players={}})}]),angular.module("videoModule").controller("AdminVideoUploadCtrl",function(){}),angular.module("videoModule").controller("AdminDeleteCtrl",["$scope","$modal","$location","$state",function(a,b,c,d){function e(){}a.delModal=function(b,c){a.delVideo={},a.delVideo.id=b,a.delVideo.title=c,a.open()},a.open=function(){var c=b.open({templateUrl:"/admin/views/modal.html",controller:ModalInstanceCtrl,resolve:{delVideo:function(){return a.delVideo}}});c.result.then(function(){e(a.delVideo.id),d.reload()},function(){})}}]);var ModalInstanceCtrl=["$scope","$modalInstance","delVideo",function(a,b,c){a.videoInfo=c,a.ok=function(){b.close()},a.cancel=function(){b.dismiss("cancel")}}];angular.module("studioModule",["ngRoute","ui.router"]).config(["$stateProvider","$urlRouterProvider",function(a){a.state("studiosAll",{url:"/dashboard/studios/all",templateUrl:"/admin/views/studios_all.html",controller:"AdminStudioAllCtrl"}).state("studiosCreate",{url:"/dashboard/studios/new",templateUrl:"/admin/views/studio_create.html",controller:"AdminStudioCreateCtrl"}).state("studiosDetails",{url:"/dashboard/studios/:studioId",templateUrl:"/admin/views/studio_detail.html",resolve:{studioPromise:["Restangular","$stateParams",function(a,b){return a.one("studios",b.studioId).get().then(function(a){return a})}],videosPromise:["Restangular","$stateParams",function(a,b){return a.one("studios",b.studioId).getList("videos",{limit:5,fields:"uid,title,slug,description,created,status"}).then(function(a){return a})}]},controller:"AdminStudioDetailsCtrl"})}]),angular.module("studioModule").controller("AdminStudioDetailsCtrl",["$scope","studioPromise","videosPromise",function(a,b,c){a.studio=b,a.videos=c}]),angular.module("studioModule").controller("AdminStudioCreateCtrl",function(){}),angular.module("AdminApp",["userModule","videoModule","studioModule","ngRoute","ui.bootstrap","ui.router","xeditable","restangular","angular-loading-bar","checklist-model","angularMoment"]).config(["$interpolateProvider","$locationProvider","$sceDelegateProvider","RestangularProvider","cfpLoadingBarProvider","$stateProvider","$urlRouterProvider",function(a,b,c,d,e,f,g){a.startSymbol("{[{"),a.endSymbol("}]}"),b.html5Mode(!0),d.setBaseUrl("http://api.3drs.synth3tk.com"),e.latencyThreshold=500,e.includeSpinner=!1,c.resourceUrlWhitelist(["self","http://slate.3digitalrockstudios.com.s3.amazonaws.com/**"]),d.addResponseInterceptor(function(a,b){var c;return c="getList"===b?a.items:a}),f.state("dashboard",{url:"/dashboard",templateUrl:"/admin/views/home.html",controller:"AdminDashboardCtrl"}),g.otherwise("/dashboard")}]).controller("AdminDashboardCtrl",["$scope",function(){}]).run(["$rootScope","editableOptions",function(a,b){b.theme="default"}]);